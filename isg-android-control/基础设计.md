参照matter-server脚本包，进行isg-android-control服务管理脚本包设计，分别设计和创建每个脚本文件，以下是基本要求：


# isg-android-control 服务管理脚本包设计

**Service ID:** `isg-android-control`


## 脚本文件清单及功能说明

| 脚本名               | 功能描述                          |
| ----------------- | ----------------------------- |
| `common_paths.sh` | 统一路径定义                        |
| `install.sh`      | 安装 isg-android-control 服务                |
| `start.sh`        | 启动 isg-android-control 服务                |
| `stop.sh`         | 停止 isg-android-control 服务，恢复 `.disabled` |
| `status.sh`       | 查询服务运行状态，依据 PID 和 运行isg-android-control status查看状态     |
| `update.sh`       | 升级 isg-android-control                  |
| `uninstall.sh`    | 卸载 isg-android-control 环境及配置             |
| `autocheck.sh`    | 单服务自检与性能监控                    |


## 操作命令及管理规范

### 1. 在 `isgservicemonitor` 下启停命令
| 操作    | 命令                                                                                |
| ----- | --------------------------------------------------------------------------------- |
| 启动    | `echo u > /data/data/com.termux/files/usr/var/service/isg-android-control/supervise/control` |
| 停止    | `echo d > /data/data/com.termux/files/usr/var/service/isg-android-control/supervise/control` |
| 禁用自启动 | `touch /data/data/com.termux/files/usr/var/service/isg-android-control/down`                 |
| 启用自启动 | `rm -f /data/data/com.termux/files/usr/var/service/isg-android-control/down`                 |

#### 2 安装服务
1） 使用如下方式安装
    proot-distro login ubuntu << 'EOF'
    commands
    'EOF'
2） 与依赖分开安装，避免由于依赖无法安装影响应用的安装

### 复制安装程序,并进行安装

```bash
    proot-distro login "$PROOT_DISTRO" -- bash -c "
    cp -r /data/data/com.termux/files/home/servicemanager/isg-android-control
/android-control/ /root/
    cd /root/android-control
    bash install.sh
```

### 启动程序之前需要先检查redis是否启动
```bash
  netstat -tulpn | grep 6379           #检查端口6379是否启动
  redis-server /etc/redis/redis.conf   #如果端口没有启动，则启动redis
```
---

### ⬆️ 获取版本

```bash
   proot-distro login ubuntu -- bash -c '
   cd /root/android-control
   isg-android-control version

```
### ⬆️ 获取进程
```bash
pgrep -f "python3 -m isg_android_control.run"

```

---
### ⬆️ 配置config.yaml
文件在proot ubuntu的 /root/android-control/config/路径下面
有apps.yaml  device.yaml  mqtt.yaml
需要读取mqtt.yaml里的mqtt的用户名和密码
需要读取apps.yaml里的App列表


### 注册 servicemonitor 服务看护

```bash
# -----------------------------------------------------------------------------
# 注册 servicemonitor 服务看护
# -----------------------------------------------------------------------------
log "registering servicemonitor service"
mqtt_report "isg/install/$SERVICE_ID/status" "{\"status\":\"installing\",\"message\":\"registering servicemonitor service\",\"timestamp\":$(date +%s)}"

# 创建服务目录
mkdir -p "$SERVICE_CONTROL_DIR"

# 写入 run 启动脚本
cat << 'EOF' > "$RUN_FILE"
#!/data/data/com.termux/files/usr/bin/sh
export PROCESS_TAG="${PROCESS_TAG}"

exec proot-distro login ubuntu -- bash -lc '
  set -e
  cd /root/android-control
  isg-android-control start
'
EOF

# 赋予执行权限
chmod +x "$RUN_FILE"

# 创建 down 文件（初始状态不自启）
touch "$DOWN_FILE"
```


### 4. MQTT上报
BASE_DIR="/data/data/com.termux/files/home/servicemanager"
CONFIG_FILE="$BASE_DIR/configuration.yaml"
MQTT broker信息来自于CONFIG_FILE里的mqtt

---

### 5. 路径定义
common_paths.sh 仅仅是统一路径定义的规范
不要加载统一路径定义，每个脚本使用独立参数，无需依赖common_paths.sh

### 6. autocheck要求
配置信息在/root/isg-guardian/config.yaml里，只提取mqtt的配置信息和app列表

### 8. 状态查询要求
bash status.sh, 只输出running/stopped
通过查版本号来确定程序是否安装，增加mqtt状态上报，install：true/false
bash status.sh --json 输出详细json内容

### 9. 升级命令
没有升级

### 10. 其它要求
关键步骤加上中文注释
Termux 专用的临时目录：
  - TERMUX_TMP_DIR="/data/data/com.termux/files/usr/tmp"
  - TEMP_DIR="$TERMUX_TMP_DIR/${SERVICE_ID}_temp"
